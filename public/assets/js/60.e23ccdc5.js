(window.webpackJsonp=window.webpackJsonp||[]).push([[60],{373:function(s,e,t){"use strict";t.r(e);var a=t(0),n=Object(a.a)({},(function(){var s=this,e=s.$createElement,t=s._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"kuberentes-离线丝滑安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#kuberentes-离线丝滑安装"}},[s._v("#")]),s._v(" kuberentes 离线丝滑安装")]),s._v(" "),t("p",[s._v("为了让kubernetes安装与集群节点管理更丝滑，这次我们是花了大功夫。这次做了很多非常大的更新，并经过充分测试与bug修复让其稳定。")]),s._v(" "),t("p",[s._v("力争把这个简单的事做到极致。")]),s._v(" "),t("blockquote",[t("p",[s._v("剥离定制kubeam功能到sealos中")])]),s._v(" "),t("p",[s._v("之前定制kubeadm代码实现的100年证书功能和localLB,已经全部剥离到sealos中，现在已经是完完全全原生的kubernetes了。")]),s._v(" "),t("p",[s._v("为了减少对第三方命令行工具的依赖，sealos证书完全是通过调用golang的库生成，生成逻辑与kubeadm保持一致，不过把client-go中写死一年的证书时间变成了一个参数。")]),s._v(" "),t("p",[s._v("ipvs的localLB断然也不屑于去调用类似ipvsadm的工具，也是走系统调用完成，还顺便修复了netlink和内核版本不兼容的问题，这个问题1.18版本的kube-proxy目前一直存在需要升级内核解决。")]),s._v(" "),t("blockquote",[t("p",[s._v("自由的增加删除master或node节点")])]),s._v(" "),t("p",[s._v("统统一条命令的事，难道找到其它的如此丝滑简单的方式增删你集群中的节点了")]),s._v(" "),t("blockquote",[t("p",[s._v("超全的kubernetes版本支持")])]),s._v(" "),t("p",[s._v("基本官方release的正式版我们都会在1个工作日内发布离线包。 所以基本是全网最快最全，而且为了用户有更好的下载体验，放到阿里云oss上了,下载丝滑。")]),s._v(" "),t("p",[s._v("之所以我们这么快得益于我们的打包和自动化测试机器人。")]),s._v(" "),t("blockquote",[t("p",[s._v("体验优化再优化")])]),s._v(" "),t("ul",[t("li",[s._v("精简日志输出")]),s._v(" "),t("li",[s._v("实时流日志，大部分远程执行命令的工具日志都是同步输出，就是等到日志执行完再返回给标准输出，而sealos执行远程命令时异步输出，这就丝滑太多了。")]),s._v(" "),t("li",[s._v("lvscare开机ipvs内核模块加载")])]),s._v(" "),t("h2",{attrs:{id:"🚀-快速开始"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#🚀-快速开始"}},[s._v("#")]),s._v(" 🚀 快速开始")]),s._v(" "),t("blockquote",[t("p",[s._v("环境信息")])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("主机名")]),s._v(" "),t("th",[s._v("IP地址")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("master0")]),s._v(" "),t("td",[s._v("192.168.0.2")])]),s._v(" "),t("tr",[t("td",[s._v("master1")]),s._v(" "),t("td",[s._v("192.168.0.3")])]),s._v(" "),t("tr",[t("td",[s._v("master2")]),s._v(" "),t("td",[s._v("192.168.0.4")])]),s._v(" "),t("tr",[t("td",[s._v("node0")]),s._v(" "),t("td",[s._v("192.168.0.5")])])])]),s._v(" "),t("p",[s._v("服务器密码：123456")]),s._v(" "),t("blockquote",[t("p",[s._v("只需要准备好服务器，在任意一台服务器上执行下面命令即可")])]),s._v(" "),t("div",{staticClass:"language-sh line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-sh"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载并安装sealos, sealos是个golang的二进制工具，直接下载拷贝到bin目录即可, release页面也可下载")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -c https://sealyun.oss-cn-beijing.aliyuncs.com/latest/sealos "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x sealos "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" sealos /usr/bin \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载离线资源包")]),s._v("\n$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" -c https://sealyun.oss-cn-beijing.aliyuncs.com/d551b0b9e67e0416d0f9dce870a16665-1.18.0/kube1.18.0.tar.gz \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装一个三master的kubernetes集群")]),s._v("\n$ sealos init --passwd "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("123456")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t--master "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.2  --master "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.3  --master "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.4  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t--node "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.5 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t--pkg-url /root/kube1.18.0.tar.gz "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n\t--version v1.18.0\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("blockquote",[t("p",[s._v("参数含义")])]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("参数名")]),s._v(" "),t("th",[s._v("含义")]),s._v(" "),t("th",[s._v("示例")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("passwd")]),s._v(" "),t("td",[s._v("服务器密码")]),s._v(" "),t("td",[s._v("123456")])]),s._v(" "),t("tr",[t("td",[s._v("master")]),s._v(" "),t("td",[s._v("k8s master节点IP地址")]),s._v(" "),t("td",[s._v("192.168.0.2")])]),s._v(" "),t("tr",[t("td",[s._v("node")]),s._v(" "),t("td",[s._v("k8s node节点IP地址")]),s._v(" "),t("td",[s._v("192.168.0.3")])]),s._v(" "),t("tr",[t("td",[s._v("pkg-url")]),s._v(" "),t("td",[s._v("离线资源包地址，支持下载到本地，或者一个远程地址")]),s._v(" "),t("td",[s._v("/root/kube1.16.0.tar.gz")])]),s._v(" "),t("tr",[t("td",[s._v("version")]),s._v(" "),t("td",[t("a",{attrs:{href:"http://store.lameleg.com",target:"_blank",rel:"noopener noreferrer"}},[s._v("资源包"),t("OutboundLink")],1),s._v("对应的版本")]),s._v(" "),t("td",[s._v("v1.16.0")])])])]),s._v(" "),t("blockquote",[t("p",[s._v("增加master")])]),s._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("🐳 → sealos "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" --master "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.6 --master "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.7\n🐳 → sealos "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" --master "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.6-192.168.0.9  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者多个连续IP")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("blockquote",[t("p",[s._v("增加node")])]),s._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("🐳 → sealos "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" --node "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.6 --node "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.7\n🐳 → sealos "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("join")]),s._v(" --node "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.6-192.168.0.9  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者多个连续IP")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("blockquote",[t("p",[s._v("删除指定master节点")])]),s._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("🐳 → sealos clean --master "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.6 --master "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.7\n🐳 → sealos clean --master "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.6-192.168.0.9  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者多个连续IP")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("blockquote",[t("p",[s._v("删除指定node节点")])]),s._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("🐳 → sealos clean --node "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.6 --node "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.7\n🐳 → sealos clean --node "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".0.6-192.168.0.9  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 或者多个连续IP")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("blockquote",[t("p",[s._v("清理集群")])]),s._v(" "),t("div",{staticClass:"language-shell script line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("🐳 → sealos clean\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])])])}),[],!1,null,null,null);e.default=n.exports}}]);